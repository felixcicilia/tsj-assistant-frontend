<!-- src/app/account/users/editar-usuarios/editar-usuarios.component.html -->

<div class="container py-3">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h4 class="mb-0">Editar usuario</h4>

    <a routerLink="/account/users" class="btn btn-sm btn-outline-secondary">
      ← Volver al listado
    </a>
  </div>

  <div *ngIf="errorMsg" class="alert alert-danger">
    {{ errorMsg }}
  </div>

  <div *ngIf="loading" class="text-muted">
    Cargando datos del usuario…
  </div>

  <div *ngIf="!loading && userLoaded" class="card border-0 shadow-sm">
    <div class="card-body">
      <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <div class="row g-3">
          <!-- First name -->
          <div class="col-md-6">
            <label class="form-label">Nombre</label>
            <input
              type="text"
              class="form-control"
              formControlName="name"
              placeholder="Nombre"
            />
            <div
              *ngIf="hasError('name', 'required')"
              class="text-danger small mt-1"
            >
              El nombre es obligatorio.
            </div>
          </div>

          <!-- Last name -->
          <div class="col-md-6">
            <label class="form-label">Apellido</label>
            <input
              type="text"
              class="form-control"
              formControlName="lastName"
              placeholder="Apellido"
            />
          </div>

          <!-- Document -->
          <div class="col-md-4">
            <label class="form-label">Cédula / Documento</label>
            <input
              type="text"
              class="form-control"
              formControlName="documentId"
              placeholder="V-12345678"
            />
          </div>

          <!-- Phone -->
          <div class="col-md-4">
            <label class="form-label">Teléfono</label>
            <input
              type="text"
              class="form-control"
              formControlName="phone"
              placeholder="+58..."
            />
          </div>

          <!-- Email -->
          <div class="col-md-4">
            <label class="form-label">Correo electrónico</label>
            <input
              type="email"
              class="form-control"
              formControlName="email"
              placeholder="usuario@tsj.test"
            />
            <div
              *ngIf="hasError('email', 'required')"
              class="text-danger small mt-1"
            >
              El correo es obligatorio.
            </div>
            <div
              *ngIf="hasError('email', 'email')"
              class="text-danger small mt-1"
            >
              El formato del correo no es válido.
            </div>
          </div>

          <!-- Address -->
          <div class="col-12">
            <label class="form-label">Dirección</label>
            <input
              type="text"
              class="form-control"
              formControlName="address"
              placeholder="Dirección completa"
            />
          </div>

          <!-- State -->
          <div class="col-md-4">
            <label class="form-label">Estado / Provincia</label>
            <input
              type="text"
              class="form-control"
              formControlName="state"
              placeholder="Estado"
            />
          </div>

          <!-- Country -->
          <div class="col-md-4">
            <label class="form-label">País</label>
            <input
              type="text"
              class="form-control"
              formControlName="country"
              placeholder="País"
            />
          </div>

          <!-- Role -->
          <div class="col-md-4">
            <label class="form-label">Rol</label>
            <select class="form-select" formControlName="role">
              <option value="">Seleccione un rol…</option>
              <option *ngFor="let r of roles" [value]="r">
                {{ r }}
              </option>
            </select>
            <div
              *ngIf="hasError('role', 'required')"
              class="text-danger small mt-1"
            >
              El rol es obligatorio.
            </div>
          </div>
        </div>

        <div class="d-flex justify-content-end gap-2 mt-4">
          <button
            type="button"
            class="btn btn-outline-secondary"
            routerLink="/account/users"
            [disabled]="saving"
          >
            Cancelar
          </button>

          <button
            type="submit"
            class="btn btn-primary"
            [disabled]="saving || form.invalid"
          >
            <span
              class="spinner-border spinner-border-sm me-2"
              *ngIf="saving"
            ></span>
            Guardar cambios
          </button>
        </div>
      </form>
    </div>
  </div>
</div>